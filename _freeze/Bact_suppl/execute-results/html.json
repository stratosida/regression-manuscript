{
  "hash": "e3de3097af52def171e71c3ff22e49f6",
  "result": {
    "markdown": "# Supplementary Example\n\n\n::: {.cell}\n\n:::\n\n\n## Overview\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# define key predictors without pseudo-log trafo ('orig') and transformed ('trans'), replace WBC with WBC_noNEU\nkey_predictors_orig  <- bact_variables$vip_vars %>%\n  str_replace('WBC', 'WBC_noNEU')\nkey_predictors_trans <- bact_transformed$vip_vars %>%\n  str_replace('WBC', 'WBC_noNEU')\n\n# include only complete cases\nmodel_df_complete <- c_bact[c('BC', unique(c(bact_variables$vip_vars, bact_transformed$vip_vars)))] %>%\n  mutate(\n    WBC_noNEU = WBC - NEU\n  ) %>%\n  na.omit\n\nmodel_df_complete <- model_df_complete %>%\n  mutate(\n    t_WBC_noNEU = pseudo_log(WBC_noNEU, ida_trans(model_df_complete$WBC_noNEU)$const) \n  )\n\nn_excl_cases <- dim(c_bact)[1] - dim(model_df_complete)[1] \npct_excl <- round((1-(dim(model_df_complete)[1] / dim(c_bact)[1])) * 100,1)\npct_complete <- dim(model_df_complete)[1] / dim(c_bact)[1] * 100\n```\n:::\n\n\nIn the following examples we use the Bacteremia data with complete observations regarding the key predictors WBC_noNEU, Alter, BUN, KREA, NEU, PLT, which represent 93.9% of the whole dataset. We will fit a global logistic regression model with the outcome 'BC' and the key predictors as covariates. We will use pseudo-log transformations as suggested in the IDA. Within the model, all key predictors will be transformed by fractional polynomials of order 1 (df = 2).\n\nThe aim of the examples is to showcase how decisions derived from IDA influence the results of the fitted model.\n\n## Global Model\n\nThe global model will be fitted by the *mfp* function. If not indicated otherwise, we will use the fp-transformations of the key predictors determined in global model in all consecutive models. For all models we report McFaddens's RÂ² and the AUC, i.e. the area under the ROC curve, and boxplots comparing BC predictions with outcomes.\n\n### Model Summary\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglobal_formula <- paste0('BC ~ ', paste(paste0(paste0('fp(', key_predictors_trans), ',df=2)'), collapse = ' + '))\n\nfit_mfp_complete <- mfp(as.formula(global_formula),\n                        data = model_df_complete,\n                        family = binomial)\n\n# save global formula with fp-trafos\nglobal_formula_fp <- paste('BC ~ ', paste0(tidy(fit_mfp_complete)$term[-1], collapse = ' + '))\n\ntidy(fit_mfp_complete) %>%\n  gt_model_table(title = 'global model')\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"cuctktzgwl\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#cuctktzgwl .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#cuctktzgwl .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#cuctktzgwl .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#cuctktzgwl .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#cuctktzgwl .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cuctktzgwl .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#cuctktzgwl .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#cuctktzgwl .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#cuctktzgwl .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#cuctktzgwl .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#cuctktzgwl .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#cuctktzgwl .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#cuctktzgwl .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#cuctktzgwl .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#cuctktzgwl .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#cuctktzgwl .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#cuctktzgwl .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cuctktzgwl .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#cuctktzgwl .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#cuctktzgwl .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cuctktzgwl .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#cuctktzgwl .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#cuctktzgwl .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cuctktzgwl .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cuctktzgwl .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#cuctktzgwl .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#cuctktzgwl .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cuctktzgwl .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#cuctktzgwl .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cuctktzgwl .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#cuctktzgwl .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cuctktzgwl .gt_left {\n  text-align: left;\n}\n\n#cuctktzgwl .gt_center {\n  text-align: center;\n}\n\n#cuctktzgwl .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#cuctktzgwl .gt_font_normal {\n  font-weight: normal;\n}\n\n#cuctktzgwl .gt_font_bold {\n  font-weight: bold;\n}\n\n#cuctktzgwl .gt_font_italic {\n  font-style: italic;\n}\n\n#cuctktzgwl .gt_super {\n  font-size: 65%;\n}\n\n#cuctktzgwl .gt_two_val_uncert {\n  display: inline-block;\n  line-height: 1em;\n  text-align: right;\n  font-size: 60%;\n  vertical-align: -0.25em;\n  margin-left: 0.1em;\n}\n\n#cuctktzgwl .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#cuctktzgwl .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#cuctktzgwl .gt_slash_mark {\n  font-size: 0.7em;\n  line-height: 0.7em;\n  vertical-align: 0.15em;\n}\n\n#cuctktzgwl .gt_fraction_numerator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: 0.45em;\n}\n\n#cuctktzgwl .gt_fraction_denominator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: -0.05em;\n}\n</style>\n<table class=\"gt_table\">\n  <thead class=\"gt_header\">\n    <tr>\n      <th colspan=\"5\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>global model</th>\n    </tr>\n    \n  </thead>\n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\">term</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">std.error</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">p.value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_left\">(Intercept)</td>\n<td class=\"gt_row gt_right\">&minus;2.04</td>\n<td class=\"gt_row gt_right\">0.38</td>\n<td class=\"gt_row gt_right\">&minus;5.33</td>\n<td class=\"gt_row gt_right\">1.00 &times; 10<sup class='gt_super'>&minus;7</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I((t_WBC_noNEU + 0.1)^0.5)</td>\n<td class=\"gt_row gt_right\">&minus;5.24</td>\n<td class=\"gt_row gt_right\">0.26</td>\n<td class=\"gt_row gt_right\">&minus;20.40</td>\n<td class=\"gt_row gt_right\">1.71 &times; 10<sup class='gt_super'>&minus;92</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I((t_NEU + 0.1)^1)</td>\n<td class=\"gt_row gt_right\">2.00</td>\n<td class=\"gt_row gt_right\">0.16</td>\n<td class=\"gt_row gt_right\">12.67</td>\n<td class=\"gt_row gt_right\">8.39 &times; 10<sup class='gt_super'>&minus;37</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I((Alter/100)^1)</td>\n<td class=\"gt_row gt_right\">1.60</td>\n<td class=\"gt_row gt_right\">0.21</td>\n<td class=\"gt_row gt_right\">7.71</td>\n<td class=\"gt_row gt_right\">1.25 &times; 10<sup class='gt_super'>&minus;14</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I(t_KREA^1)</td>\n<td class=\"gt_row gt_right\">0.60</td>\n<td class=\"gt_row gt_right\">0.20</td>\n<td class=\"gt_row gt_right\">2.98</td>\n<td class=\"gt_row gt_right\">2.87 &times; 10<sup class='gt_super'>&minus;3</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I(((PLT + 1)/100)^1)</td>\n<td class=\"gt_row gt_right\">&minus;0.08</td>\n<td class=\"gt_row gt_right\">0.03</td>\n<td class=\"gt_row gt_right\">&minus;2.46</td>\n<td class=\"gt_row gt_right\">1.38 &times; 10<sup class='gt_super'>&minus;2</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I(t_BUN^1)</td>\n<td class=\"gt_row gt_right\">0.23</td>\n<td class=\"gt_row gt_right\">0.19</td>\n<td class=\"gt_row gt_right\">1.22</td>\n<td class=\"gt_row gt_right\">2.23 &times; 10<sup class='gt_super'>&minus;1</sup></td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n\n```{.r .cell-code}\n#Mc Fadden's RÂ²\n#r_squared_mcfadden <- with(summary(fit_mfp_complete), 1 - deviance/null.deviance)\n\n#AUC\nAUC = auc(fit_mfp_complete$y, predict(fit_mfp_complete, type = 'response'))\n\np_model_complete <- logreg_summary_plot(fit_mfp_complete, 'global model')\n\np_model_complete\n```\n\n::: {.cell-output-display}\n![](Bact_suppl_files/figure-html/global model-1.png){width=192}\n:::\n:::\n\n\n### Functional forms of global model\n\nWe now take a look at the functional forms of the covariates in the global model, which are determined by the fp algorithm. Besides scaling factors, only for t_WBC_noNEU the fp algorithm chose a non-linear transformation (note the '\\^0.5' in the term column). This means all other covariates enter the model in a linear fashion. In the following effect plots, each variable is adjusted to the median of the other variables in the model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# medians of all key predictors, selected variables will be adjusted to these medians in effect plots\nmodel_df_medians <- model_df_complete[,unique(c(key_predictors_orig, key_predictors_trans))] %>%\n  summarise_all(median)\n\nfor(i in 1:length(key_predictors_trans)){\n\n  new_data <- bind_cols(\n    model_df_medians,\n    x = model_df_complete[,key_predictors_trans[i]]\n    ) %>%\n    select(-key_predictors_trans[i]) %>%\n    as_tibble() %>%\n    distinct()\n  \n  pred_complete <- predict(fit_mfp_complete, \n                        newdata = new_data %>%\n                          rename(!!key_predictors_trans[i] := x),  # is needed so predict finds the variables\n                        type = 'link', se.fit = TRUE)\n\n  plot_df <- cbind(\n    new_data,\n    yhat = pred_complete$fit,\n    yhat.lwr = pred_complete$fit - 1.96*pred_complete$se.fit,\n    yhat.upr = pred_complete$fit + 1.96*pred_complete$se.fit\n    ) %>%\n    as_tibble() \n  \n  p <- plot_df %>% \n    ggplot(aes(x = x, y = yhat, ymin = yhat.lwr, ymax = yhat.upr)) +\n    geom_ribbon(alpha = .2, color = NA) +\n    geom_line() +\n    geom_rug(\n      data = fit_mfp_complete$X %>% as.data.frame, \n      aes_string(x = key_predictors_trans[i]), \n      inherit.aes = FALSE) +\n    labs(\n      y = 'log odds',\n      x = key_predictors_trans[i]\n    ) +\n    theme_minimal()\n  \n  print(p)\n  \n  if(key_predictors_trans[i] == 'PLT'){ p_effect_PLT <- p} # save for example 5\n}\n```\n\n::: {.cell-output-display}\n![](Bact_suppl_files/figure-html/global model functional forms-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Bact_suppl_files/figure-html/global model functional forms-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Bact_suppl_files/figure-html/global model functional forms-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Bact_suppl_files/figure-html/global model functional forms-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Bact_suppl_files/figure-html/global model functional forms-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Bact_suppl_files/figure-html/global model functional forms-6.png){width=672}\n:::\n:::\n\n\n## Example 1: to transform or not to transform\n\nOnly for one out of the six key predictors did the fp algorithm chose a non-linear transformation. But out of those six variables, four were pseudo-log transformed before entering the model. In the first example we want to compare the global model to a model using the key predictors on their original scale.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# fit the complete mfp model using only original, non-transformed variables\nfit_mfp_complete_notrans <- mfp(as.formula(global_formula %>% str_replace_all('t\\\\_', '')),\n                     data = model_df_complete,\n                     family = binomial)\n\ntidy(fit_mfp_complete_notrans) %>% gt_model_table('global model without pseudo-log tranformations')\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"hkfimitszp\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#hkfimitszp .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hkfimitszp .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hkfimitszp .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hkfimitszp .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hkfimitszp .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hkfimitszp .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hkfimitszp .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hkfimitszp .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hkfimitszp .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hkfimitszp .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hkfimitszp .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hkfimitszp .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hkfimitszp .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hkfimitszp .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hkfimitszp .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hkfimitszp .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hkfimitszp .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hkfimitszp .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hkfimitszp .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hkfimitszp .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hkfimitszp .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hkfimitszp .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hkfimitszp .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hkfimitszp .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hkfimitszp .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hkfimitszp .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hkfimitszp .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hkfimitszp .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hkfimitszp .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hkfimitszp .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hkfimitszp .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hkfimitszp .gt_left {\n  text-align: left;\n}\n\n#hkfimitszp .gt_center {\n  text-align: center;\n}\n\n#hkfimitszp .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hkfimitszp .gt_font_normal {\n  font-weight: normal;\n}\n\n#hkfimitszp .gt_font_bold {\n  font-weight: bold;\n}\n\n#hkfimitszp .gt_font_italic {\n  font-style: italic;\n}\n\n#hkfimitszp .gt_super {\n  font-size: 65%;\n}\n\n#hkfimitszp .gt_two_val_uncert {\n  display: inline-block;\n  line-height: 1em;\n  text-align: right;\n  font-size: 60%;\n  vertical-align: -0.25em;\n  margin-left: 0.1em;\n}\n\n#hkfimitszp .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#hkfimitszp .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hkfimitszp .gt_slash_mark {\n  font-size: 0.7em;\n  line-height: 0.7em;\n  vertical-align: 0.15em;\n}\n\n#hkfimitszp .gt_fraction_numerator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: 0.45em;\n}\n\n#hkfimitszp .gt_fraction_denominator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: -0.05em;\n}\n</style>\n<table class=\"gt_table\">\n  <thead class=\"gt_header\">\n    <tr>\n      <th colspan=\"5\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>global model without pseudo-log tranformations</th>\n    </tr>\n    \n  </thead>\n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\">term</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">std.error</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">p.value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_left\">(Intercept)</td>\n<td class=\"gt_row gt_right\">&minus;3.18</td>\n<td class=\"gt_row gt_right\">0.28</td>\n<td class=\"gt_row gt_right\">&minus;11.17</td>\n<td class=\"gt_row gt_right\">5.48 &times; 10<sup class='gt_super'>&minus;29</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">log((WBC_noNEU + 0.2))</td>\n<td class=\"gt_row gt_right\">&minus;1.25</td>\n<td class=\"gt_row gt_right\">0.06</td>\n<td class=\"gt_row gt_right\">&minus;20.22</td>\n<td class=\"gt_row gt_right\">5.92 &times; 10<sup class='gt_super'>&minus;91</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I(((NEU + 0.1)/10)^0.5)</td>\n<td class=\"gt_row gt_right\">1.52</td>\n<td class=\"gt_row gt_right\">0.12</td>\n<td class=\"gt_row gt_right\">12.99</td>\n<td class=\"gt_row gt_right\">1.34 &times; 10<sup class='gt_super'>&minus;38</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I((Alter/100)^1)</td>\n<td class=\"gt_row gt_right\">1.64</td>\n<td class=\"gt_row gt_right\">0.20</td>\n<td class=\"gt_row gt_right\">8.26</td>\n<td class=\"gt_row gt_right\">1.51 &times; 10<sup class='gt_super'>&minus;16</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I(((PLT + 1)/100)^1)</td>\n<td class=\"gt_row gt_right\">&minus;0.08</td>\n<td class=\"gt_row gt_right\">0.03</td>\n<td class=\"gt_row gt_right\">&minus;2.53</td>\n<td class=\"gt_row gt_right\">1.13 &times; 10<sup class='gt_super'>&minus;2</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I((BUN/10)^1)</td>\n<td class=\"gt_row gt_right\">0.02</td>\n<td class=\"gt_row gt_right\">0.02</td>\n<td class=\"gt_row gt_right\">0.68</td>\n<td class=\"gt_row gt_right\">5.00 &times; 10<sup class='gt_super'>&minus;1</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I(KREA^-0.5)</td>\n<td class=\"gt_row gt_right\">&minus;0.77</td>\n<td class=\"gt_row gt_right\">0.21</td>\n<td class=\"gt_row gt_right\">&minus;3.69</td>\n<td class=\"gt_row gt_right\">2.20 &times; 10<sup class='gt_super'>&minus;4</sup></td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nNote the different fp-transformation arising when the key predictors are not pseudo-log transformed. On the original scale, three covariates instead of one now enter the model via a non-linear fp-transformation. This suggests that a transfromation prior to the regression model 'outsources' the need for transformations within the model. Now let us compare the model performances.\n\n\n::: {.cell}\n\n```{.r .cell-code}\np_model_notrans <- logreg_summary_plot(fit_mfp_complete_notrans, 'global model \\nwithout pseudo-log \\ntransformations') # maybe side by side with global model?\n\np_model_complete + coord_cartesian(ylim = c(0,.8)) + p_model_notrans + theme(axis.title.y = element_blank()) + coord_cartesian(ylim = c(0,.8))\n```\n\n::: {.cell-output-display}\n![](Bact_suppl_files/figure-html/unnamed-chunk-4-1.png){width=384}\n:::\n:::\n\n\nWith regards to McFadden's RÂ² and the AUC, the differences between the two approaches is marginal.\n\nNext we will compare the differences of the functional forms in the two models for those covariates where a pseudo-log transformation was suggested in IDA. We will look at the log odds for bacteremia by each covariate on the original and the transformed scale, and compare the global model using the original and the pseudo-log transformed covariates. Each variable is adjusted for the median of all other variables used.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in 1:length(key_predictors_trans)){\n  if(key_predictors_orig[i] != key_predictors_trans[i]){\n  \n    new_data <- bind_cols(\n      model_df_medians,\n      x_orig  = model_df_complete[,key_predictors_orig[i]],\n      x_trans = model_df_complete[,key_predictors_trans[i]]\n      ) %>%\n      select(-key_predictors_orig[i], -key_predictors_trans[i]) %>%\n      as_tibble() %>%\n      distinct()\n    \n    pred_trans <- predict(fit_mfp_complete, \n                          newdata = new_data %>%\n                            rename(  # is needed so predict finds the variables\n                              !!key_predictors_orig[i] := x_orig,\n                              !!key_predictors_trans[i] := x_trans), \n                          type = 'link', se.fit = TRUE)\n    pred_original <- predict(fit_mfp_complete_notrans, \n                             newdata = new_data %>%\n                               rename(\n                                 !!key_predictors_orig[i] := x_orig,\n                                 !!key_predictors_trans[i] := x_trans), \n                             type = 'link', se.fit = TRUE)\n    \n    plot_df <- cbind(\n      new_data,\n      yhat_original = pred_original$fit,\n      yhat.lwr_original = pred_original$fit - 1.96*pred_original$se.fit,\n      yhat.upr_original = pred_original$fit + 1.96*pred_original$se.fit,\n      yhat_trans = pred_trans$fit,\n      yhat.lwr_trans = pred_trans$fit - 1.96*pred_trans$se.fit,\n      yhat.upr_trans = pred_trans$fit + 1.96*pred_trans$se.fit\n      ) %>%\n      as_tibble() %>%\n      pivot_longer(\n        cols = contains('yhat')\n      ) %>%\n      separate(name, c('var', 'model'), sep = '_') %>%\n      pivot_wider(\n        names_from = 'var', values_from = 'value'\n      ) %>%\n      mutate(\n        model = case_when(\n          model == 'trans' ~ 'pseudo-log transformed',\n          model == 'original' ~ 'original scale'\n        )\n      )\n    \n    \n    p_original <- plot_df %>% \n      ggplot(aes(x = x_orig, y = yhat, ymin = yhat.lwr, ymax = yhat.upr, color = model, fill = model)) +\n      geom_ribbon(alpha = .2, color = NA) +\n      geom_line() +\n      geom_rug(data = fit_mfp_complete_notrans$X %>% as.data.frame, \n        aes_string(x = key_predictors_orig[i]), \n        inherit.aes = FALSE\n      ) +\n      labs(\n        y = 'log odds',\n        title = 'on original scale',\n        x = key_predictors_orig[i],\n        color = 'model with data on',\n        fill = 'model with data on'\n      ) +\n      theme_minimal() +\n      scale_color_ptol() +\n      scale_fill_ptol()\n    \n    p_trans <- plot_df %>%\n      ggplot(aes(x = x_trans, y = yhat, ymin = yhat.lwr, ymax = yhat.upr, color = model, fill = model)) +\n      geom_ribbon(alpha = .2, color = NA) +\n      geom_line() +\n      geom_rug(data = fit_mfp_complete$X %>% as.data.frame, \n        aes_string(x = key_predictors_trans[i]), \n        inherit.aes = FALSE\n      ) +\n      labs(\n        y = 'log odds',\n        title = 'on pseudo-log scale',\n        x = key_predictors_trans[i],\n        color = 'model with data on',\n        fill = 'model with data on'\n      ) +\n      theme_minimal() +\n      scale_color_ptol() +\n      scale_fill_ptol()\n    \n    p <- p_original + (p_trans +\n                    theme(\n                      axis.title.y = element_text(color = NA)\n                    )) +\n      plot_layout(guides = 'collect') +\n      plot_annotation(caption = 'adjusted to medians of all other covariates')  & \n      theme(legend.position = 'bottom')\n    \n    print(p)\n  }\n  \n}\n```\n\n::: {.cell-output-display}\n![](Bact_suppl_files/figure-html/trafo of variables-1.png){width=960}\n:::\n\n::: {.cell-output-display}\n![](Bact_suppl_files/figure-html/trafo of variables-2.png){width=960}\n:::\n\n::: {.cell-output-display}\n![](Bact_suppl_files/figure-html/trafo of variables-3.png){width=960}\n:::\n\n::: {.cell-output-display}\n![](Bact_suppl_files/figure-html/trafo of variables-4.png){width=960}\n:::\n:::\n\n\n## Example 2: the support of a model determines what it can explain\n\nNext we compare the global model to a model were for an important variable, in our case we chose age, the variable support is reduced to the central 50% of the data (i.e. data within the 25% and 75% quantiles). Again, in the reduced models we use the same fp-transformations as in the global model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_pct <- .5\n\nsel_central <- (model_df_complete$Alter > quantile(model_df_complete$Alter, 0.5-m_pct/2)) & \n  (model_df_complete$Alter < quantile(model_df_complete$Alter, 0.5+m_pct/2)) #needed later\n\nset.seed(2)\nsel_sample <- as.logical(round(runif(dim(model_df_complete)[1]))) # 50% random selection, needed later\n\npred_complete <- predict(fit_mfp_complete, \n                         newdata = model_df_complete,\n                         type = 'response')\ny_complete <- fit_mfp_complete$y\n\npred_central <- predict(fit_mfp_complete, \n                         newdata = model_df_complete[sel_central,],\n                         type = 'response')\ny_central <- fit_mfp_complete$y[sel_central]\n\npred_sample <- predict(fit_mfp_complete, \n                         newdata = model_df_complete[sel_sample,],\n                         type = 'response')\ny_sample <- fit_mfp_complete$y[sel_sample]\n\n\nr_squared_efron <- function(y, prediction){\n  n <- length(y)\n  1-(((1/n)*sum((y-prediction)^2))/((1/n)*sum((y-mean(y))^2)))\n}\n\ntribble(\n  ~data, ~AUC, ~`sacled Brier score`,\n  'complete', auc(y_complete, pred_complete) %>% as.numeric(), cor(y_complete, pred_complete)^2,\n  'central 50%', auc(y_central, pred_central) %>% as.numeric(), cor(y_central, pred_central)^2,\n  '50% sample', auc(y_sample, pred_sample) %>% as.numeric(), cor(y_sample, pred_sample)^2,\n  ) %>%\n  gt() %>%\n  fmt_number(2, decimals = 3) %>%\n  fmt_number(3, decimals = 5)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"mhwqvfwlfy\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#mhwqvfwlfy .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mhwqvfwlfy .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mhwqvfwlfy .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#mhwqvfwlfy .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#mhwqvfwlfy .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mhwqvfwlfy .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mhwqvfwlfy .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mhwqvfwlfy .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mhwqvfwlfy .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mhwqvfwlfy .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mhwqvfwlfy .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mhwqvfwlfy .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mhwqvfwlfy .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mhwqvfwlfy .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mhwqvfwlfy .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mhwqvfwlfy .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mhwqvfwlfy .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mhwqvfwlfy .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mhwqvfwlfy .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mhwqvfwlfy .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mhwqvfwlfy .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#mhwqvfwlfy .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mhwqvfwlfy .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mhwqvfwlfy .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mhwqvfwlfy .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#mhwqvfwlfy .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#mhwqvfwlfy .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mhwqvfwlfy .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mhwqvfwlfy .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mhwqvfwlfy .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mhwqvfwlfy .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mhwqvfwlfy .gt_left {\n  text-align: left;\n}\n\n#mhwqvfwlfy .gt_center {\n  text-align: center;\n}\n\n#mhwqvfwlfy .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mhwqvfwlfy .gt_font_normal {\n  font-weight: normal;\n}\n\n#mhwqvfwlfy .gt_font_bold {\n  font-weight: bold;\n}\n\n#mhwqvfwlfy .gt_font_italic {\n  font-style: italic;\n}\n\n#mhwqvfwlfy .gt_super {\n  font-size: 65%;\n}\n\n#mhwqvfwlfy .gt_two_val_uncert {\n  display: inline-block;\n  line-height: 1em;\n  text-align: right;\n  font-size: 60%;\n  vertical-align: -0.25em;\n  margin-left: 0.1em;\n}\n\n#mhwqvfwlfy .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#mhwqvfwlfy .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mhwqvfwlfy .gt_slash_mark {\n  font-size: 0.7em;\n  line-height: 0.7em;\n  vertical-align: 0.15em;\n}\n\n#mhwqvfwlfy .gt_fraction_numerator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: 0.45em;\n}\n\n#mhwqvfwlfy .gt_fraction_denominator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: -0.05em;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\">data</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">AUC</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">sacled Brier score</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_left\">complete</td>\n<td class=\"gt_row gt_right\">0.732</td>\n<td class=\"gt_row gt_right\">0.06456</td></tr>\n    <tr><td class=\"gt_row gt_left\">central 50%</td>\n<td class=\"gt_row gt_right\">0.723</td>\n<td class=\"gt_row gt_right\">0.05321</td></tr>\n    <tr><td class=\"gt_row gt_left\">50% sample</td>\n<td class=\"gt_row gt_right\">0.737</td>\n<td class=\"gt_row gt_right\">0.06587</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n\n```{.r .cell-code}\np_ex2 <- rbind(\n  tibble(\n    BC = y_complete,\n    prediction = pred_complete,\n    model = 'complete data'\n  ),\n  tibble(\n    BC = y_central,\n    prediction = pred_central,\n    model = 'within IQR (age)'\n  ),\n  tibble(\n    BC = y_sample,\n    prediction = pred_sample,\n    model = 'random 50% subsample'\n  )) %>%\n  mutate(model = factor(model, levels = c('complete data', 'within IQR (age)', 'random 50% subsample'))) %>%\n  ggplot(aes(x = factor(BC), y = prediction, group = BC)) +\n  geom_boxplot() + \n  facet_grid(~model) +\n  theme_minimal() +\n  labs(x = 'BC')\n\np_ex2\n```\n\n::: {.cell-output-display}\n![](Bact_suppl_files/figure-html/prediction validity-1.png){width=576}\n:::\n:::\n\n\n## Example 3: the limits of mulitiple imputation\n\nTo show the effect of multiple imputation if the number of missing values is high, we construct a dataset with 50% artificially generated missing values in one variable. First, recall the output of the complete model, relying on the Bacteremia data with complete cases regarding the key predictors.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(fit_mfp_complete) %>% gt_model_table('global model')\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"lvxliwfzxs\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#lvxliwfzxs .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#lvxliwfzxs .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lvxliwfzxs .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#lvxliwfzxs .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#lvxliwfzxs .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lvxliwfzxs .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lvxliwfzxs .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#lvxliwfzxs .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#lvxliwfzxs .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#lvxliwfzxs .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#lvxliwfzxs .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#lvxliwfzxs .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#lvxliwfzxs .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#lvxliwfzxs .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#lvxliwfzxs .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#lvxliwfzxs .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#lvxliwfzxs .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lvxliwfzxs .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#lvxliwfzxs .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#lvxliwfzxs .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lvxliwfzxs .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#lvxliwfzxs .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#lvxliwfzxs .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lvxliwfzxs .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lvxliwfzxs .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#lvxliwfzxs .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#lvxliwfzxs .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lvxliwfzxs .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lvxliwfzxs .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lvxliwfzxs .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lvxliwfzxs .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lvxliwfzxs .gt_left {\n  text-align: left;\n}\n\n#lvxliwfzxs .gt_center {\n  text-align: center;\n}\n\n#lvxliwfzxs .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#lvxliwfzxs .gt_font_normal {\n  font-weight: normal;\n}\n\n#lvxliwfzxs .gt_font_bold {\n  font-weight: bold;\n}\n\n#lvxliwfzxs .gt_font_italic {\n  font-style: italic;\n}\n\n#lvxliwfzxs .gt_super {\n  font-size: 65%;\n}\n\n#lvxliwfzxs .gt_two_val_uncert {\n  display: inline-block;\n  line-height: 1em;\n  text-align: right;\n  font-size: 60%;\n  vertical-align: -0.25em;\n  margin-left: 0.1em;\n}\n\n#lvxliwfzxs .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#lvxliwfzxs .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#lvxliwfzxs .gt_slash_mark {\n  font-size: 0.7em;\n  line-height: 0.7em;\n  vertical-align: 0.15em;\n}\n\n#lvxliwfzxs .gt_fraction_numerator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: 0.45em;\n}\n\n#lvxliwfzxs .gt_fraction_denominator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: -0.05em;\n}\n</style>\n<table class=\"gt_table\">\n  <thead class=\"gt_header\">\n    <tr>\n      <th colspan=\"5\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>global model</th>\n    </tr>\n    \n  </thead>\n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\">term</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">std.error</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">p.value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_left\">(Intercept)</td>\n<td class=\"gt_row gt_right\">&minus;2.04</td>\n<td class=\"gt_row gt_right\">0.38</td>\n<td class=\"gt_row gt_right\">&minus;5.33</td>\n<td class=\"gt_row gt_right\">1.00 &times; 10<sup class='gt_super'>&minus;7</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I((t_WBC_noNEU + 0.1)^0.5)</td>\n<td class=\"gt_row gt_right\">&minus;5.24</td>\n<td class=\"gt_row gt_right\">0.26</td>\n<td class=\"gt_row gt_right\">&minus;20.40</td>\n<td class=\"gt_row gt_right\">1.71 &times; 10<sup class='gt_super'>&minus;92</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I((t_NEU + 0.1)^1)</td>\n<td class=\"gt_row gt_right\">2.00</td>\n<td class=\"gt_row gt_right\">0.16</td>\n<td class=\"gt_row gt_right\">12.67</td>\n<td class=\"gt_row gt_right\">8.39 &times; 10<sup class='gt_super'>&minus;37</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I((Alter/100)^1)</td>\n<td class=\"gt_row gt_right\">1.60</td>\n<td class=\"gt_row gt_right\">0.21</td>\n<td class=\"gt_row gt_right\">7.71</td>\n<td class=\"gt_row gt_right\">1.25 &times; 10<sup class='gt_super'>&minus;14</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I(t_KREA^1)</td>\n<td class=\"gt_row gt_right\">0.60</td>\n<td class=\"gt_row gt_right\">0.20</td>\n<td class=\"gt_row gt_right\">2.98</td>\n<td class=\"gt_row gt_right\">2.87 &times; 10<sup class='gt_super'>&minus;3</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I(((PLT + 1)/100)^1)</td>\n<td class=\"gt_row gt_right\">&minus;0.08</td>\n<td class=\"gt_row gt_right\">0.03</td>\n<td class=\"gt_row gt_right\">&minus;2.46</td>\n<td class=\"gt_row gt_right\">1.38 &times; 10<sup class='gt_super'>&minus;2</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I(t_BUN^1)</td>\n<td class=\"gt_row gt_right\">0.23</td>\n<td class=\"gt_row gt_right\">0.19</td>\n<td class=\"gt_row gt_right\">1.22</td>\n<td class=\"gt_row gt_right\">2.23 &times; 10<sup class='gt_super'>&minus;1</sup></td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nCreatinine ('KREA') is significant at a level that might not survive substantial missingness. We thus create a dataset were we artificially introduce 50% missing creatinine values, missing completely at random.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create 50% missings for t_KREA\nset.seed(3) # with seed=3, z-statistic for t_KREA is 1.48\nmodel_df_missings <- model_df_complete %>%\n  mutate(\n    t_KREA = ifelse(\n      runif(dim(model_df_complete)[1]) < .5,  #~50%/50% TURE/FALSE\n      t_KREA,\n      NA\n    )\n  )\n```\n:::\n\n\nNext we fit a 'complete case' model in the case of missing creatinine data, using the fp-transformations from the global model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_mfp_missing <- glm(as.formula(global_formula_fp), #use same fp-trafos as in global model\n                       data = model_df_missings,\n                       family = binomial)\n```\n:::\n\n\nNow we impute the missing creatinine data using MICE with 50 imputations, fit the model using the fp-transformations from the global model and pool the results.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# impute\nimp_data <- mice(model_df_missings %>%\n                   select(BC, key_predictors_trans), \n                 m=50, maxit = 50, method='pmm', seed = 1)\n\n# fit imputed data\nimp_fits <- with(imp_data,\n                 glm(as.formula(global_formula_fp), #use same fp-trafos as in global model\n                 family = binomial)\n  )\n\n# pooled results\nfit_pooled <- pool(imp_fits)\n```\n:::\n\n\nWe now can compare the outputs of the complete model, the complete model with missing data (i.e. only half of the original complete data is used), and the imputed model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbind_rows(\n  tidy(fit_mfp_complete)  %>% mutate(model = 'global model'),\n  tidy(fit_mfp_missing) %>% mutate(model = 'missing, complete cases'),\n  summary(fit_pooled) %>% select(-df) %>% as_tibble() %>% mutate(model = 'missing, imputed')\n  ) %>%\n  relocate(term, model) %>%\n  arrange(term, model) %>%\n  group_by(term) %>%\n  group_by(term_old = term) %>%\n  mutate(\n    term = c(unique(term_old), rep('', n()-1))\n  ) %>%\n  ungroup %>%\n  select(-term_old) %>%\n  gt %>%\n  fmt_number(\n    3:5,\n    decimals = 3\n  ) %>%\n  fmt_scientific(6)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"mrhrnmqkka\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#mrhrnmqkka .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mrhrnmqkka .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mrhrnmqkka .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#mrhrnmqkka .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#mrhrnmqkka .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mrhrnmqkka .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mrhrnmqkka .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mrhrnmqkka .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mrhrnmqkka .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mrhrnmqkka .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mrhrnmqkka .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mrhrnmqkka .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mrhrnmqkka .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mrhrnmqkka .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mrhrnmqkka .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mrhrnmqkka .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mrhrnmqkka .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mrhrnmqkka .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mrhrnmqkka .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mrhrnmqkka .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mrhrnmqkka .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#mrhrnmqkka .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mrhrnmqkka .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mrhrnmqkka .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mrhrnmqkka .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#mrhrnmqkka .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#mrhrnmqkka .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mrhrnmqkka .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mrhrnmqkka .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mrhrnmqkka .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mrhrnmqkka .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mrhrnmqkka .gt_left {\n  text-align: left;\n}\n\n#mrhrnmqkka .gt_center {\n  text-align: center;\n}\n\n#mrhrnmqkka .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mrhrnmqkka .gt_font_normal {\n  font-weight: normal;\n}\n\n#mrhrnmqkka .gt_font_bold {\n  font-weight: bold;\n}\n\n#mrhrnmqkka .gt_font_italic {\n  font-style: italic;\n}\n\n#mrhrnmqkka .gt_super {\n  font-size: 65%;\n}\n\n#mrhrnmqkka .gt_two_val_uncert {\n  display: inline-block;\n  line-height: 1em;\n  text-align: right;\n  font-size: 60%;\n  vertical-align: -0.25em;\n  margin-left: 0.1em;\n}\n\n#mrhrnmqkka .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#mrhrnmqkka .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mrhrnmqkka .gt_slash_mark {\n  font-size: 0.7em;\n  line-height: 0.7em;\n  vertical-align: 0.15em;\n}\n\n#mrhrnmqkka .gt_fraction_numerator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: 0.45em;\n}\n\n#mrhrnmqkka .gt_fraction_denominator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: -0.05em;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\">term</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\">model</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">std.error</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">p.value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_left\">(Intercept)</td>\n<td class=\"gt_row gt_left\">global model</td>\n<td class=\"gt_row gt_right\">&minus;2.036</td>\n<td class=\"gt_row gt_right\">0.382</td>\n<td class=\"gt_row gt_right\">&minus;5.326</td>\n<td class=\"gt_row gt_right\">1.00 &times; 10<sup class='gt_super'>&minus;7</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\"></td>\n<td class=\"gt_row gt_left\">missing, complete cases</td>\n<td class=\"gt_row gt_right\">&minus;2.601</td>\n<td class=\"gt_row gt_right\">0.541</td>\n<td class=\"gt_row gt_right\">&minus;4.806</td>\n<td class=\"gt_row gt_right\">1.54 &times; 10<sup class='gt_super'>&minus;6</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\"></td>\n<td class=\"gt_row gt_left\">missing, imputed</td>\n<td class=\"gt_row gt_right\">&minus;2.069</td>\n<td class=\"gt_row gt_right\">0.384</td>\n<td class=\"gt_row gt_right\">&minus;5.385</td>\n<td class=\"gt_row gt_right\">7.36 &times; 10<sup class='gt_super'>&minus;8</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I(((PLT + 1)/100)^1)</td>\n<td class=\"gt_row gt_left\">global model</td>\n<td class=\"gt_row gt_right\">&minus;0.079</td>\n<td class=\"gt_row gt_right\">0.032</td>\n<td class=\"gt_row gt_right\">&minus;2.462</td>\n<td class=\"gt_row gt_right\">1.38 &times; 10<sup class='gt_super'>&minus;2</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\"></td>\n<td class=\"gt_row gt_left\">missing, complete cases</td>\n<td class=\"gt_row gt_right\">&minus;0.118</td>\n<td class=\"gt_row gt_right\">0.046</td>\n<td class=\"gt_row gt_right\">&minus;2.544</td>\n<td class=\"gt_row gt_right\">1.10 &times; 10<sup class='gt_super'>&minus;2</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\"></td>\n<td class=\"gt_row gt_left\">missing, imputed</td>\n<td class=\"gt_row gt_right\">&minus;0.078</td>\n<td class=\"gt_row gt_right\">0.032</td>\n<td class=\"gt_row gt_right\">&minus;2.439</td>\n<td class=\"gt_row gt_right\">1.48 &times; 10<sup class='gt_super'>&minus;2</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I((Alter/100)^1)</td>\n<td class=\"gt_row gt_left\">global model</td>\n<td class=\"gt_row gt_right\">1.601</td>\n<td class=\"gt_row gt_right\">0.208</td>\n<td class=\"gt_row gt_right\">7.711</td>\n<td class=\"gt_row gt_right\">1.25 &times; 10<sup class='gt_super'>&minus;14</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\"></td>\n<td class=\"gt_row gt_left\">missing, complete cases</td>\n<td class=\"gt_row gt_right\">1.910</td>\n<td class=\"gt_row gt_right\">0.296</td>\n<td class=\"gt_row gt_right\">6.443</td>\n<td class=\"gt_row gt_right\">1.17 &times; 10<sup class='gt_super'>&minus;10</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\"></td>\n<td class=\"gt_row gt_left\">missing, imputed</td>\n<td class=\"gt_row gt_right\">1.591</td>\n<td class=\"gt_row gt_right\">0.210</td>\n<td class=\"gt_row gt_right\">7.573</td>\n<td class=\"gt_row gt_right\">3.91 &times; 10<sup class='gt_super'>&minus;14</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I((t_NEU + 0.1)^1)</td>\n<td class=\"gt_row gt_left\">global model</td>\n<td class=\"gt_row gt_right\">2.000</td>\n<td class=\"gt_row gt_right\">0.158</td>\n<td class=\"gt_row gt_right\">12.673</td>\n<td class=\"gt_row gt_right\">8.39 &times; 10<sup class='gt_super'>&minus;37</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\"></td>\n<td class=\"gt_row gt_left\">missing, complete cases</td>\n<td class=\"gt_row gt_right\">2.113</td>\n<td class=\"gt_row gt_right\">0.225</td>\n<td class=\"gt_row gt_right\">9.375</td>\n<td class=\"gt_row gt_right\">6.94 &times; 10<sup class='gt_super'>&minus;21</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\"></td>\n<td class=\"gt_row gt_left\">missing, imputed</td>\n<td class=\"gt_row gt_right\">1.998</td>\n<td class=\"gt_row gt_right\">0.158</td>\n<td class=\"gt_row gt_right\">12.644</td>\n<td class=\"gt_row gt_right\">0.00</td></tr>\n    <tr><td class=\"gt_row gt_left\">I((t_WBC_noNEU + 0.1)^0.5)</td>\n<td class=\"gt_row gt_left\">global model</td>\n<td class=\"gt_row gt_right\">&minus;5.236</td>\n<td class=\"gt_row gt_right\">0.257</td>\n<td class=\"gt_row gt_right\">&minus;20.399</td>\n<td class=\"gt_row gt_right\">1.71 &times; 10<sup class='gt_super'>&minus;92</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\"></td>\n<td class=\"gt_row gt_left\">missing, complete cases</td>\n<td class=\"gt_row gt_right\">&minus;5.007</td>\n<td class=\"gt_row gt_right\">0.366</td>\n<td class=\"gt_row gt_right\">&minus;13.677</td>\n<td class=\"gt_row gt_right\">1.39 &times; 10<sup class='gt_super'>&minus;42</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\"></td>\n<td class=\"gt_row gt_left\">missing, imputed</td>\n<td class=\"gt_row gt_right\">&minus;5.221</td>\n<td class=\"gt_row gt_right\">0.256</td>\n<td class=\"gt_row gt_right\">&minus;20.355</td>\n<td class=\"gt_row gt_right\">0.00</td></tr>\n    <tr><td class=\"gt_row gt_left\">I(t_BUN^1)</td>\n<td class=\"gt_row gt_left\">global model</td>\n<td class=\"gt_row gt_right\">0.226</td>\n<td class=\"gt_row gt_right\">0.185</td>\n<td class=\"gt_row gt_right\">1.220</td>\n<td class=\"gt_row gt_right\">2.23 &times; 10<sup class='gt_super'>&minus;1</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\"></td>\n<td class=\"gt_row gt_left\">missing, complete cases</td>\n<td class=\"gt_row gt_right\">0.401</td>\n<td class=\"gt_row gt_right\">0.264</td>\n<td class=\"gt_row gt_right\">1.519</td>\n<td class=\"gt_row gt_right\">1.29 &times; 10<sup class='gt_super'>&minus;1</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\"></td>\n<td class=\"gt_row gt_left\">missing, imputed</td>\n<td class=\"gt_row gt_right\">0.302</td>\n<td class=\"gt_row gt_right\">0.227</td>\n<td class=\"gt_row gt_right\">1.332</td>\n<td class=\"gt_row gt_right\">1.84 &times; 10<sup class='gt_super'>&minus;1</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\">I(t_KREA^1)</td>\n<td class=\"gt_row gt_left\">global model</td>\n<td class=\"gt_row gt_right\">0.598</td>\n<td class=\"gt_row gt_right\">0.201</td>\n<td class=\"gt_row gt_right\">2.982</td>\n<td class=\"gt_row gt_right\">2.87 &times; 10<sup class='gt_super'>&minus;3</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\"></td>\n<td class=\"gt_row gt_left\">missing, complete cases</td>\n<td class=\"gt_row gt_right\">0.429</td>\n<td class=\"gt_row gt_right\">0.289</td>\n<td class=\"gt_row gt_right\">1.485</td>\n<td class=\"gt_row gt_right\">1.38 &times; 10<sup class='gt_super'>&minus;1</sup></td></tr>\n    <tr><td class=\"gt_row gt_left\"></td>\n<td class=\"gt_row gt_left\">missing, imputed</td>\n<td class=\"gt_row gt_right\">0.483</td>\n<td class=\"gt_row gt_right\">0.277</td>\n<td class=\"gt_row gt_right\">1.745</td>\n<td class=\"gt_row gt_right\">8.25 &times; 10<sup class='gt_super'>&minus;2</sup></td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nThe z-statistic for creatinine drops from 2.98 to 1.49 when half the data is missing. Also in other variables the z-statistic is less extreme in the 'missing, complete case analysis' compared to the global model. The interesting observations is that MI recreates estimates and standard errors very close to the global model in most variables, but not in the one that was being imputed, namely creatinine. In variable selection, chreatinine, which is highly significant in the 'true' model, is likely to be dropped, based on the imputed data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#pearson & spearman correalation of CREA and BUN\n\nr_pearson  <- cor(model_df_complete$t_KREA, model_df_complete$BUN, method = 'pearson') %>% round(3)\nr_spearman <- cor(model_df_complete$t_KREA, model_df_complete$BUN, method = 'spearman') %>% round(3)\n```\n:::\n\n\n## Example 4: Interpretation of regression coefficient 'size'\n\nThe variables WBC_noNEU and t_WBC_noNEU are on two very different scales:\n\n\n::: {.cell}\n\n```{.r .cell-code}\np_ex4 <- model_df_complete %>%\n  select(key_predictors_trans[str_detect(key_predictors_trans, 't_')]) %>%\n  mutate_all(as.numeric) %>%\n  pivot_longer(cols = everything()) %>%\n  ggplot(aes(x = value, group = name)) + \n  facet_wrap(~name, scales = 'free', strip.position = \"bottom\") +\n  geom_histogram(fill = 'firebrick2', color = NA, alpha = 0.5) +\n  theme_minimal() +\n  theme(strip.placement = 'outside')\n\np_ex4\n```\n\n::: {.cell-output-display}\n![](Bact_suppl_files/figure-html/ex 4 plots-1.png){width=576}\n:::\n\n```{.r .cell-code}\n# standardized regression coefficients\n\ntidy(fit_mfp_complete) %>%\n  select(term, estimate) %>%\n  filter(term != '(Intercept)') \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 Ã 2\n  term                       estimate\n  <chr>                         <dbl>\n1 I((t_WBC_noNEU + 0.1)^0.5)  -5.24  \n2 I((t_NEU + 0.1)^1)           2.00  \n3 I((Alter/100)^1)             1.60  \n4 I(t_KREA^1)                  0.598 \n5 I(((PLT + 1)/100)^1)        -0.0789\n6 I(t_BUN^1)                   0.226 \n```\n:::\n\n```{.r .cell-code}\nmodel_df_complete %>%\n  summarise(\n    WBC_noNEU = sd(((t_WBC_noNEU + 0.1)^0.5) * fit_mfp_complete$coefficients[2]),\n    NEU = sd((t_NEU + 0.1) * fit_mfp_complete$coefficients[3]),\n    Age = sd((Alter / 100) * fit_mfp_complete$coefficients[4]),\n    CREA = sd((t_KREA) * fit_mfp_complete$coefficients[5]),\n    PLT = sd(((PLT + 1) / 100) * fit_mfp_complete$coefficients[6]),\n    BUN = sd((t_BUN) * fit_mfp_complete$coefficients[7])\n  ) %>%\n  pivot_longer(cols = everything(), names_to = 'variable', values_to = 'standardized beta') %>%\n  gt %>%\n  fmt_number(\n    2, decimals = 4\n  )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"axgrpwnzia\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#axgrpwnzia .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#axgrpwnzia .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#axgrpwnzia .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#axgrpwnzia .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#axgrpwnzia .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#axgrpwnzia .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#axgrpwnzia .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#axgrpwnzia .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#axgrpwnzia .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#axgrpwnzia .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#axgrpwnzia .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#axgrpwnzia .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#axgrpwnzia .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#axgrpwnzia .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#axgrpwnzia .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#axgrpwnzia .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#axgrpwnzia .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#axgrpwnzia .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#axgrpwnzia .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#axgrpwnzia .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#axgrpwnzia .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#axgrpwnzia .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#axgrpwnzia .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#axgrpwnzia .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#axgrpwnzia .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#axgrpwnzia .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#axgrpwnzia .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#axgrpwnzia .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#axgrpwnzia .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#axgrpwnzia .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#axgrpwnzia .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#axgrpwnzia .gt_left {\n  text-align: left;\n}\n\n#axgrpwnzia .gt_center {\n  text-align: center;\n}\n\n#axgrpwnzia .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#axgrpwnzia .gt_font_normal {\n  font-weight: normal;\n}\n\n#axgrpwnzia .gt_font_bold {\n  font-weight: bold;\n}\n\n#axgrpwnzia .gt_font_italic {\n  font-style: italic;\n}\n\n#axgrpwnzia .gt_super {\n  font-size: 65%;\n}\n\n#axgrpwnzia .gt_two_val_uncert {\n  display: inline-block;\n  line-height: 1em;\n  text-align: right;\n  font-size: 60%;\n  vertical-align: -0.25em;\n  margin-left: 0.1em;\n}\n\n#axgrpwnzia .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#axgrpwnzia .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#axgrpwnzia .gt_slash_mark {\n  font-size: 0.7em;\n  line-height: 0.7em;\n  vertical-align: 0.15em;\n}\n\n#axgrpwnzia .gt_fraction_numerator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: 0.45em;\n}\n\n#axgrpwnzia .gt_fraction_denominator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: -0.05em;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">standardized beta</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_left\">WBC_noNEU</td>\n<td class=\"gt_row gt_right\">0.7029</td></tr>\n    <tr><td class=\"gt_row gt_left\">NEU</td>\n<td class=\"gt_row gt_right\">0.4551</td></tr>\n    <tr><td class=\"gt_row gt_left\">Age</td>\n<td class=\"gt_row gt_right\">0.2912</td></tr>\n    <tr><td class=\"gt_row gt_left\">CREA</td>\n<td class=\"gt_row gt_right\">0.1310</td></tr>\n    <tr><td class=\"gt_row gt_left\">PLT</td>\n<td class=\"gt_row gt_right\">0.0959</td></tr>\n    <tr><td class=\"gt_row gt_left\">BUN</td>\n<td class=\"gt_row gt_right\">0.0623</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nLet us recall the two estimates to the covariates WBC_noNEU and t_WBC_noNEU.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbind_rows(\n  tidy(fit_mfp_complete) %>% select(term, estimate),\n  tidy(fit_mfp_complete_notrans) %>% select(term, estimate)\n  ) %>% \n  filter(str_detect(term, 'WBC')) %>%\n  gt %>%\n  fmt_number(2, decimals = 2)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"vsztgjtwyo\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#vsztgjtwyo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#vsztgjtwyo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vsztgjtwyo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#vsztgjtwyo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#vsztgjtwyo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vsztgjtwyo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vsztgjtwyo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#vsztgjtwyo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#vsztgjtwyo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#vsztgjtwyo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#vsztgjtwyo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#vsztgjtwyo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#vsztgjtwyo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#vsztgjtwyo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#vsztgjtwyo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#vsztgjtwyo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#vsztgjtwyo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vsztgjtwyo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#vsztgjtwyo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#vsztgjtwyo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vsztgjtwyo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#vsztgjtwyo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#vsztgjtwyo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vsztgjtwyo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vsztgjtwyo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#vsztgjtwyo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#vsztgjtwyo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vsztgjtwyo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vsztgjtwyo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vsztgjtwyo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vsztgjtwyo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vsztgjtwyo .gt_left {\n  text-align: left;\n}\n\n#vsztgjtwyo .gt_center {\n  text-align: center;\n}\n\n#vsztgjtwyo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#vsztgjtwyo .gt_font_normal {\n  font-weight: normal;\n}\n\n#vsztgjtwyo .gt_font_bold {\n  font-weight: bold;\n}\n\n#vsztgjtwyo .gt_font_italic {\n  font-style: italic;\n}\n\n#vsztgjtwyo .gt_super {\n  font-size: 65%;\n}\n\n#vsztgjtwyo .gt_two_val_uncert {\n  display: inline-block;\n  line-height: 1em;\n  text-align: right;\n  font-size: 60%;\n  vertical-align: -0.25em;\n  margin-left: 0.1em;\n}\n\n#vsztgjtwyo .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#vsztgjtwyo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#vsztgjtwyo .gt_slash_mark {\n  font-size: 0.7em;\n  line-height: 0.7em;\n  vertical-align: 0.15em;\n}\n\n#vsztgjtwyo .gt_fraction_numerator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: 0.45em;\n}\n\n#vsztgjtwyo .gt_fraction_denominator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: -0.05em;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\">term</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">estimate</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_left\">I((t_WBC_noNEU + 0.1)^0.5)</td>\n<td class=\"gt_row gt_right\">&minus;5.24</td></tr>\n    <tr><td class=\"gt_row gt_left\">log((WBC_noNEU + 0.2))</td>\n<td class=\"gt_row gt_right\">&minus;1.25</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n(Suggestion: show this with models without fp trafo?)\n\nBecause the fp-transformations further complicate the interpretation of the regression coefficients, let us consider two logisitc regression models with WBC_noNEU and t_WBC_noNEU as single covariate, respectively.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_wbc_orig <- glm(BC ~ WBC_noNEU,\n                    data = model_df_complete,\n                    family = binomial) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n```\n:::\n\n```{.r .cell-code}\nfit_wbc_trans <- glm(BC ~ t_WBC_noNEU,\n                     data = model_df_complete,\n                     family = binomial) \n\nbind_rows(\n  tidy(fit_wbc_orig),\n  tidy(fit_wbc_trans)\n  ) %>%\n  filter(str_detect(term, 'WBC')) %>%\n  select(term, estimate) %>%\n  gt %>%\n  fmt_number(estimate, decimals = 2)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"inlyyobpkb\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#inlyyobpkb .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#inlyyobpkb .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#inlyyobpkb .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#inlyyobpkb .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#inlyyobpkb .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#inlyyobpkb .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#inlyyobpkb .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#inlyyobpkb .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#inlyyobpkb .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#inlyyobpkb .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#inlyyobpkb .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#inlyyobpkb .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#inlyyobpkb .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#inlyyobpkb .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#inlyyobpkb .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#inlyyobpkb .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#inlyyobpkb .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#inlyyobpkb .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#inlyyobpkb .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#inlyyobpkb .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#inlyyobpkb .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#inlyyobpkb .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#inlyyobpkb .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#inlyyobpkb .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#inlyyobpkb .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#inlyyobpkb .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#inlyyobpkb .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#inlyyobpkb .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#inlyyobpkb .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#inlyyobpkb .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#inlyyobpkb .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#inlyyobpkb .gt_left {\n  text-align: left;\n}\n\n#inlyyobpkb .gt_center {\n  text-align: center;\n}\n\n#inlyyobpkb .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#inlyyobpkb .gt_font_normal {\n  font-weight: normal;\n}\n\n#inlyyobpkb .gt_font_bold {\n  font-weight: bold;\n}\n\n#inlyyobpkb .gt_font_italic {\n  font-style: italic;\n}\n\n#inlyyobpkb .gt_super {\n  font-size: 65%;\n}\n\n#inlyyobpkb .gt_two_val_uncert {\n  display: inline-block;\n  line-height: 1em;\n  text-align: right;\n  font-size: 60%;\n  vertical-align: -0.25em;\n  margin-left: 0.1em;\n}\n\n#inlyyobpkb .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#inlyyobpkb .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#inlyyobpkb .gt_slash_mark {\n  font-size: 0.7em;\n  line-height: 0.7em;\n  vertical-align: 0.15em;\n}\n\n#inlyyobpkb .gt_fraction_numerator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: 0.45em;\n}\n\n#inlyyobpkb .gt_fraction_denominator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: -0.05em;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\">term</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">estimate</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_left\">WBC_noNEU</td>\n<td class=\"gt_row gt_right\">&minus;0.56</td></tr>\n    <tr><td class=\"gt_row gt_left\">t_WBC_noNEU</td>\n<td class=\"gt_row gt_right\">&minus;2.91</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n\n```{.r .cell-code}\nfit_wbc_orig$coefficients[2] %>% round(2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWBC_noNEU \n    -0.56 \n```\n:::\n:::\n\n\nThe estimates -0.56 and -2.91 denote the change in log odds for the outcome when the 'term' variable changes by 1 unit, but cannot be compared directly. A $1$ unit change is only a small step on the original scale, where WBC_noNEU covers values from -0.15 up to 152.74. In comparison, t_WBC_noNEU lies between -0.06 up to 2.45, so change of $1$ unit cover almost half the range of the variable.\n\n## Example 5: Plot of functional form should be resticted to areas with high density\n\nThe functional forms have wide confidence intervals when the data is sparse. In presentations of the effects, plots of the functional forms can be limited to areas with high density. In this analysis, PLT was very sparse above \\~800 \\[UNITS\\], which is reflected in a large confidence interval for high PLT values. In the effect plot PLT values could be limited to values \\<800 \\[UNITS\\].\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_linear_complete <- glm(as.formula(paste0('BC ~ ', paste(key_predictors_trans, collapse = '+'))),\n                           data = model_df_complete,\n                           family = 'binomial') \n\nnew_data <- bind_cols(\n  model_df_medians[,names(model_df_medians) != 't_WBC_noNEU'],\n  t_WBC_noNEU = model_df_complete[,'t_WBC_noNEU']\n  ) %>%\n  as_tibble() %>%\n  distinct()\n\npred_linear <- predict(fit_linear_complete,\n                       newdata = new_data,  # is needed so predict finds the variables\n                      type = 'link', se.fit = TRUE)\n\npred_complete <- predict(fit_mfp_complete, \n                      newdata = new_data,  # is needed so predict finds the variables\n                      type = 'link', se.fit = TRUE)\n\nplot_df <- \n  rbind(\n    cbind(\n      new_data,\n      yhat = pred_linear$fit,\n      yhat.lwr = pred_linear$fit - 1.96*pred_linear$se.fit,\n      yhat.upr = pred_linear$fit + 1.96*pred_linear$se.fit,\n      model = 'linear'\n      ),\n    cbind(\n      new_data,\n      yhat = pred_complete$fit,\n      yhat.lwr = pred_complete$fit - 1.96*pred_complete$se.fit,\n      yhat.upr = pred_complete$fit + 1.96*pred_complete$se.fit,\n      model = 'mfp'\n      )\n  ) %>%\n  as_tibble() \n\np_ex5 <- plot_df %>% \n  ggplot(aes(x = t_WBC_noNEU, y = yhat, ymin = yhat.lwr, ymax = yhat.upr, color = model, group = model)) +\n  geom_ribbon(alpha = .2, color = NA) +\n  geom_line(size = 1) +\n  geom_rug(\n    data = fit_mfp_complete$X %>% as.data.frame, \n    aes(x = t_WBC_noNEU), \n    inherit.aes = FALSE) +\n  labs(\n    y = 'log odds'\n  ) +\n  theme_minimal() +\n  scale_color_ptol()\n\n\nlogreg_summary_plot(fit_linear_complete, 'linear model')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nSetting levels: control = 0, case = 1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nSetting direction: controls < cases\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nDon't know how to automatically pick scale for object of type labelled/integer. Defaulting to continuous.\n```\n:::\n\n::: {.cell-output-display}\n![](Bact_suppl_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\np_ex5  + (p_ex5 + coord_cartesian(xlim = quantile(model_df_complete$t_WBC_noNEU, c(.05,.95)), ylim = c(-4.5, -0.5))) +\n  plot_layout(guides = 'collect')\n```\n\n::: {.cell-output-display}\n![](Bact_suppl_files/figure-html/unnamed-chunk-14-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#p_effect_PLT + p_effect_PLT + coord_cartesian(xlim = c(0,800)) # not working because of ggplot bug\n\n#workaround because of ggplot bug\np_effect_PLT + geom_ribbon(fill = gray(.9)) + geom_line() + \n  p_effect_PLT + \n    coord_cartesian(xlim = c(0,800)) + \n    geom_ribbon(fill = gray(.9)) + \n    geom_line() +\n    theme(axis.title.y = element_blank())\n```\n\n::: {.cell-output-display}\n![](Bact_suppl_files/figure-html/example 5 plots-1.png){width=1152}\n:::\n:::\n",
    "supporting": [
      "Bact_suppl_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}